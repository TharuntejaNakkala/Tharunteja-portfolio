try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ad7cdd89-57e0-44f9-9555-f5294a0aeafa",e._sentryDebugIdIdentifier="sentry-dbid-ad7cdd89-57e0-44f9-9555-f5294a0aeafa")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4145],{17928:(e,t,r)=>{r.d(t,{f:()=>i});var i=function(e){return e.Add="add",e.Cancel="cancel",e}({})},28884:(e,t,r)=>{r.d(t,{SettingsProvider:()=>p,M:()=>g});var i=r(95155),a=r(12115);let n={reward_credit_config:{daily_login_reward:100,invite_reward:500,new_user_reward:500},invite_config:{monthly_invite_limit:10}};var o=r(65453),c=r(34477);let s=(0,c.createServerReference)("006e833908c35126e3f456312aaa0dcacef6b3dfe2",c.callServer,void 0,c.findSourceMapURL,"fetchSettingsInfo");var l=r(62128);let d=e=>({fetchSettings:async()=>{try{e({isLoading:!0,error:null});let t=await s();if(0===t.code&&t.data)e({settings:{reward_credit_config:t.data.reward_credit_config,invite_config:t.data.invite_config},isLoading:!1,error:null,lastFetchTime:Date.now()}),l.Ay.info("Settings fetched successfully",{settings:t.data});else{let r=t.message||"Failed to fetch settings";e({isLoading:!1,error:r}),l.Ay.error("Failed to fetch settings",Error(JSON.stringify(t)))}}catch(t){e({isLoading:!1,error:"Network error while fetching settings"}),l.Ay.error("Settings fetch error",t)}},setError:t=>{e({error:t})}}),u={settings:n,isLoading:!1,error:null,lastFetchTime:null},h=(0,o.v)()((e,t,r)=>({...u,...d(e,t,r)})),f=(0,a.createContext)({settings:n,isLoading:!1,error:null,refetchSettings:async()=>{}}),p=e=>{let{children:t}=e,{settings:r,isLoading:n,error:o,fetchSettings:c}=h();return(0,a.useEffect)(()=>{c()},[c]),(0,i.jsx)(f.Provider,{value:{settings:r,isLoading:n,error:o,refetchSettings:c},children:t})},g=()=>(0,a.useContext)(f)},60750:(e,t,r)=>{r.d(t,{EmojiProvider:()=>E,k:()=>C});var i=r(95155),a=r(12115),n=r(34477);let o=(0,n.createServerReference)("007e6d1648344afe6d00842459c71590c7d366b534",n.callServer,void 0,n.findSourceMapURL,"fetchEmojiList");var c=r(53568),s=r(89003),l=r(62128);let d=(0,n.createServerReference)("70f9fae1c9db37a9b38b4c799dfdeb3567c500ef7f",n.callServer,void 0,n.findSourceMapURL,"postInteract");var u=r(17928);class h{addOperation(e,t,r,i){let a="".concat(e.project_id,"-").concat(t,"-").concat(Date.now());this.queue=this.queue.filter(r=>!(r.project_id===e.project_id&&r.interaction_type===t&&!this.isOperationInProgress(r.id)));let n=e.interaction||{count:[],status:[]};n=this.calculateUpdatedInteraction(e,t,r),i&&(this.callbacks.get(e.project_id)||new Set).forEach(t=>{t(e.project_id,n)});let o={id:a,project_id:e.project_id,interaction_type:t,action:r,timestamp:Date.now()};return this.queue.push(o),this.scheduleBatch(),a}registerCallback(e,t){var r;return this.callbacks.has(e)||this.callbacks.set(e,new Set),null===(r=this.callbacks.get(e))||void 0===r||r.add(t),()=>{let r=this.callbacks.get(e);r&&(r.delete(t),0===r.size&&this.callbacks.delete(e))}}isOperationInProgress(e){return this.processingOperations.has(e)}getOperationKey(e){return"".concat(e.project_id,"-").concat(e.interaction_type)}scheduleBatch(){this.batchTimer&&clearTimeout(this.batchTimer),this.batchTimer=setTimeout(()=>{this.processQueue()},this.batchDelay)}async processQueue(){if(0===this.queue.length)return;this.batchTimer=null;let e=new Map;for(let r of this.queue){var t;let i=this.getOperationKey(r);e.has(i)||e.set(i,[]),null===(t=e.get(i))||void 0===t||t.push(r)}let r=[];for(let[t,i]of e.entries()){if(this.processingOperations.has(t))continue;let e=i[0];r.push(this.processOperation(e,t))}r.length>0&&(await Promise.all(r),this.queue.length>0&&this.scheduleBatch())}async processOperation(e,t){this.processingOperations.add(t),this.processingOperations.add(e.id);try{await d(e.project_id,e.action,e.interaction_type),this.queue=this.queue.filter(t=>t.id!==e.id)}catch(t){console.error("Failed to process interaction operation:",t),this.queue=this.queue.filter(t=>t.id!==e.id)}finally{this.processingOperations.delete(t),this.processingOperations.delete(e.id)}}calculateUpdatedInteraction(e,t,r){var i,a;let n=[...(null===(i=e.interaction)||void 0===i?void 0:i.count)||[]],o=[...(null===(a=e.interaction)||void 0===a?void 0:a.status)||[]],c=o.findIndex(e=>e.interaction_type===t);c>=0?o[c]={...o[c],status:r===u.f.Add}:r===u.f.Add&&o.push({interaction_type:t,status:!0});let s=n.findIndex(e=>e.interaction_type===t);if(s>=0){let e=r===u.f.Add?1:-1;n[s]={...n[s],count:Math.max(0,n[s].count+e)}}else r===u.f.Add&&n.push({interaction_type:t,count:1});return{count:n,status:o}}constructor(){this.queue=[],this.processingOperations=new Set,this.batchTimer=null,this.batchDelay=500,this.callbacks=new Map}}let f="yourware-emoji-list",p="yourware-emoji-lottie-cache",g=[],y=!1,v=[],m={},w=new Map,b=!1,_=e=>{v.forEach(t=>t(e)),v=[]},S=()=>{try{let e=localStorage.getItem(p);e&&(m=JSON.parse(atob(e)))}catch(e){l.vF.error("Failed to load Lottie cache",e),m={},localStorage.removeItem(p)}},T=()=>{try{localStorage.setItem(p,btoa(JSON.stringify(m)))}catch(e){l.vF.error("Failed to save Lottie cache",e)}},j=async e=>{if(!e||m[e]&&m[e].expireTime>Date.now()&&m[e].data)return;if(w.has(e))return w.get(e);let t=(async()=>{try{l.vF.trace("Start loading Lottie: ".concat(e));let t=await fetch(e),r=await t.json();m[e]={data:r,expireTime:Date.now()+864e5},T(),l.vF.trace("Lottie loaded successfully: ".concat(e))}catch(t){l.vF.error("Failed to preload Lottie: ".concat(e),t)}finally{w.delete(e)}})();return w.set(e,t),t},L=e=>{b||(b=!0,S(),setTimeout(async()=>{try{l.vF.trace("Start preloading all Lottie animations");let t=e.filter(e=>e.lottie).map(e=>e.lottie);await Promise.all([...new Set(t)].map(e=>j(e))),l.vF.trace("All Lottie animations preloaded successfully")}catch(e){l.vF.error("Failed to preload Lottie animations",e)}finally{b=!1}},2e3))},F=e=>e?m[e]&&m[e].expireTime>Date.now()&&m[e].data?m[e].data:(w.has(e)||setTimeout(()=>{j(e).catch(console.error)},0),null):null,x=()=>{try{let e=localStorage.getItem(f);if(!e)return{data:[],isExpired:!0};let t=JSON.parse(atob(e)),r=t.expireTime<Date.now();return{data:t.data,isExpired:r}}catch(e){return l.vF.error("Failed to read emoji cache",e),localStorage.removeItem(f),{data:[],isExpired:!0}}},I=e=>{try{let t={data:e,expireTime:Date.now()+3e5};localStorage.setItem(f,btoa(JSON.stringify(t)))}catch(e){l.vF.error("Failed to save emoji cache",e)}},O=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(y)return new Promise(e=>{v.push(e)});if(g.length>0&&!e)return g;if(!e){let{data:e,isExpired:t}=x();if(e.length>0)return g=e,t?setTimeout(()=>{O(!0).catch(console.error)},0):b||L(e),g}try{y=!0;let e=(await o()).data||[];return g=e,I(e),b||L(e),_(e),e}catch(e){return l.vF.error("Failed to fetch emojis",e),_(g),g}finally{y=!1}},k=(0,a.createContext)({emojis:[],isLoading:!1,getEmojiByType:()=>void 0,refreshEmojis:async()=>{},asyncGetEmojis:async()=>[],getLottieData:()=>null,interact:()=>Promise.resolve(""),registerInteractionCallback:()=>{}}),E=e=>{let{children:t}=e,[r,n]=(0,a.useState)([]),[o,l]=(0,a.useState)(!1),{user:d}=(0,c.A)(),{checkAuth:u}=(0,s.M)(),f=(0,a.useRef)(new h);(0,a.useEffect)(()=>{S()},[]),(0,a.useEffect)(()=>{let e=!0;return(async()=>{l(!0);let t=await p();e&&(n(t),l(!1))})(),()=>{e=!1}},[]);let p=async()=>{if(g.length>0){let{isExpired:e}=x();return e&&!o&&setTimeout(()=>{O(!0).catch(console.error)},0),g}return O()},y=async(e,t,r)=>u(async()=>f.current.addOperation(e,t,r,(null==d?void 0:d.uid)||""),{title:"Love this project?",description:"Log in to leave reactions and show some love.",cancelText:"Cancel",confirmText:"Log in"})()||"",v=async()=>{await O(!0)};return(0,i.jsx)(k.Provider,{value:{emojis:r,isLoading:o,getEmojiByType:e=>r.find(t=>t.interaction_type===e),refreshEmojis:v,asyncGetEmojis:p,getLottieData:F,interact:y,registerInteractionCallback:(e,t)=>{f.current.registerCallback(e,t)}},children:t})},C=()=>(0,a.useContext)(k)},89003:(e,t,r)=>{r.d(t,{M:()=>c});var i=r(35695),a=r(53568),n=r(4821),o=r(66139);let c=()=>{let{user:e}=(0,a.A)(),t=(0,i.useRouter)();return{checkAuth:(r,i)=>async function(){for(var a=arguments.length,c=Array(a),s=0;s<a;s++)c[s]=arguments[s];return e?r(...c):new Promise(e=>{(0,n.S)({title:i.title,description:i.description,cancelText:i.cancelText||"Cancel",confirmText:i.confirmText||"Log in",onCancel:()=>{e(void 0)},onConfirm:()=>{let r=(0,o.$)(!0,!0)+window.location.pathname+window.location.search;t.push("".concat((0,o.$)(!0),"/login?returnTo=").concat(encodeURIComponent(r))),e(void 0)}})})}}}}}]);