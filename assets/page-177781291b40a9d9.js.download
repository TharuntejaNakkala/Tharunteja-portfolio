try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e5b23aa1-1777-4be8-bc79-b802e550bb7d",e._sentryDebugIdIdentifier="sentry-dbid-e5b23aa1-1777-4be8-bc79-b802e550bb7d")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9144],{565:(e,t,r)=>{"use strict";r.d(t,{i:()=>l});let n=null,l=()=>n?Promise.resolve(n):new Promise(e=>{if(!window.collectEvent){e("");return}try{window.collectEvent("getToken",t=>{t&&t.ssid?(n=t.ssid,e(t.ssid)):e("")})}catch(t){e("")}})},23468:(e,t,r)=>{Promise.resolve().then(r.bind(r,56614)),Promise.resolve().then(r.bind(r,59710))},47835:(e,t,r)=>{"use strict";r.d(t,{a:()=>l});var n=r(34477);let l=(0,n.createServerReference)("609f96f93197757e98f3ef53379cb0fd45a3f2d999",n.callServer,void 0,n.findSourceMapURL,"verifyPasscode")},56614:(e,t,r)=>{"use strict";r.d(t,{default:()=>eS});var n=r(95155),l=r(25427),a=r(35695),s=r(12115),o=r(34477);let c=(0,o.createServerReference)("00d71391d50ce27f03455e2defa45bbe120e1b641a",o.callServer,void 0,o.findSourceMapURL,"syncClientIdToCookie"),i=(0,o.createServerReference)("40ef256009b0db72736ebf120dc0ee454c5d5d9eb5",o.callServer,void 0,o.findSourceMapURL,"getComments"),d=(0,o.createServerReference)("78c5e629d912d70fed32c3bdeeb5f5ba6f9d082416",o.callServer,void 0,o.findSourceMapURL,"reportStatsProjectIncr"),u=(0,o.createServerReference)("40a9f7c9d3c0b1b945836e6893d81fdc8a1469fc19",o.callServer,void 0,o.findSourceMapURL,"viewProject"),p=()=>{let[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(void 0),l=(0,s.useCallback)(()=>{t(!0)},[]),a=(0,s.useCallback)(()=>{t(!1),n(void 0)},[]);return{isOpen:e,highlightedCommentId:r,openPanel:l,closePanel:a,togglePanel:(0,s.useCallback)(()=>{t(e=>!e)},[]),setHighlightedComment:(0,s.useCallback)(e=>{n(e),e&&t(!0)},[]),setIsOpen:t,commentPanelProps:{isOpen:e,onClose:a,anchorCommentId:r}}};var x=r(80246);let m=(0,o.createServerReference)("4037e9359e23e076c01b13490264781ecb81aedda8",o.callServer,void 0,o.findSourceMapURL,"getReportReasonsAction"),f=(0,o.createServerReference)("40aa21cf61c520239e7a40ce3834dc538e8fe36dd5",o.callServer,void 0,o.findSourceMapURL,"postReportAction");var h=r(56389),v=r(48436),b=r(26846);let j={project:"Why are you reporting this project?"},g=e=>{let{contentId:t,subjectType:r,onClose:a,trackExtra:o}=e,[c,i]=(0,s.useState)([]),[d,u]=(0,s.useState)(null),[p,x]=(0,s.useState)(""),[g,w]=(0,s.useState)(!1),[_,y]=(0,s.useState)(!0),{track:N}=(0,h.s)();(0,s.useEffect)(()=>{(async()=>{y(!0);let e=await m({entity_type:r});0===e.code&&e.data?i(e.data.reasons):(0,v.P)({message:"Get report reasons failed, please try again later",type:"error"}),y(!1)})()},[]);let k=async e=>{let{reason:n,details:l}=e;N("report_submit_click",{...o,report_reason:(null==d?void 0:d.reason)==="other"?p:n}),w(!0);let s=await f({entity_type:r,entity_id:t,reason:n,details:l});w(!1),0===s.code&&s.data?(a(),(0,v.P)({message:"Thanks for reporting. We’ll review this as soon as possible.",type:"success"})):(0,v.P)({message:"Report failed, please try again later",type:"error"})},S=!_&&!g&&d;return(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex h-full w-full items-center justify-center bg-black/20",onClick:e=>{!g&&e.target===e.currentTarget&&a()},children:(0,n.jsxs)("div",{className:"flex w-[512px] max-w-[calc(100vw-32px)] flex-col gap-3 rounded-[16px] bg-white p-6 shadow-[0px_0px_2px_0px_rgba(0,0,0,0.10),0px_16px_32px_-1px_rgba(12,12,13,0.1)]",children:[(0,n.jsx)("h3",{className:"text-[20px] font-bold",children:j[r]}),(0,n.jsx)("div",{className:"flex w-full flex-col gap-1",children:_?(0,n.jsx)(n.Fragment,{children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,n.jsx)("div",{className:"h-4 w-4 animate-pulse rounded-full bg-gray-200"}),(0,n.jsx)("div",{className:"h-4 flex-1 animate-pulse rounded bg-gray-200"})]},t))}):(0,n.jsxs)(n.Fragment,{children:[c.map(e=>(0,n.jsxs)("div",{className:"flex h-8 cursor-pointer items-center gap-2",onClick:()=>u(e),children:[(0,n.jsx)("div",{className:(0,b.cn)("hover:bg-brand/10 flex h-4 w-4 items-center justify-center rounded-full border border-solid border-black/12 p-[1px] transition-colors",(null==d?void 0:d.reason)===e.reason&&"border-brand"),children:(0,n.jsx)("div",{className:(0,b.cn)("h-1.5 w-1.5 rounded-full bg-transparent",(null==d?void 0:d.reason)===e.reason&&"bg-brand")})}),(0,n.jsx)("div",{className:"flex-1 pt-0.5 text-[14px] text-black/95",children:e.description})]},e.reason)),(null==d?void 0:d.reason)==="other"&&(0,n.jsx)("input",{type:"text",className:"h-8 rounded-[10px] border border-solid border-black/12 px-2 text-[14px] text-black/95 placeholder:text-black/30",value:p,onChange:e=>x(e.target.value),placeholder:"Enter reason"})]})}),(0,n.jsxs)("div",{className:"mt-3 flex items-center justify-end gap-2",children:[(0,n.jsx)("button",{className:"h-9 w-[75px] cursor-pointer rounded-[10px] border border-solid border-black/12 text-[14px] text-black/95 hover:bg-black/6",onClick:a,disabled:g,children:"Cancel"}),(0,n.jsx)("button",{className:(0,b.cn)("bg-brand flex h-9 w-[134px] cursor-pointer items-center justify-center rounded-[10px] text-[14px] text-white disabled:opacity-50",S&&"hover:bg-brand/85"),onClick:()=>{d&&k({reason:d.reason,details:"other"===d.reason?p:void 0})},disabled:!S,children:g?(0,n.jsx)(l.rbo,{className:"h-4 w-4 animate-spin"}):"Submit Report"})]})]})})};var w=r(91844),_=r(53568),y=r(89003),N=r(4821),k=r(565),S=r(9962),C=r(66139),E=r(17928),R=r(53030),T=r(60750);r(90239);var P=r(17023),L=r(1021),A=r(70165),I=r(80191),M=r(61884),F=r(21620);let D=F.bL,U=F.l9;F.Mz,F.ZL;let O=s.forwardRef((e,t)=>{let{className:r,align:l="center",sideOffset:a=4,showArrow:s=!1,...o}=e;return(0,n.jsx)(F.ZL,{children:(0,n.jsxs)(F.UC,{ref:t,align:l,sideOffset:a,className:(0,b.cn)("z-50",r),...o,children:[o.children,s&&(0,n.jsx)(F.i3,{className:"fill-popover -my-px drop-shadow-[0_1px_0_hsl(var(--border))]"})]})})});O.displayName=F.UC.displayName;let z=()=>{try{let e=localStorage.getItem(A.V2);return!!e&&JSON.parse(e)}catch(e){return!1}},H=()=>{try{z()||localStorage.setItem(A.V2,JSON.stringify(!0))}catch(e){}},Z=e=>{let{project:t}=e,[r,l]=(0,s.useState)(!1),{user:a}=(0,_.A)();return(0,s.useEffect)(()=>{!z()&&a&&(l(!0),H())},[a]),(0,s.useEffect)(()=>{if(!r)return;let e=()=>{setTimeout(()=>{let e=document.activeElement;e&&"IFRAME"===e.tagName&&l(!1)},100)},t=()=>{l(!1)};window.addEventListener("blur",e);let n=document.querySelectorAll("iframe");return n.forEach(e=>{e.addEventListener("focus",t)}),()=>{window.removeEventListener("blur",e),n.forEach(e=>{e.removeEventListener("focus",t)})}},[r]),(0,n.jsxs)(D,{open:r,children:[(0,n.jsx)(U,{asChild:!0,children:(0,n.jsx)("div",{className:"flex h-[18px] items-center justify-center rounded-full bg-[#55644A] px-[5px] py-[1px]",children:(0,n.jsx)("span",{className:"text-xs font-bold text-white",children:"AI App"})})}),(0,n.jsx)(O,{className:"w-auto translate-x-[-40px] rounded-[10px] p-0 shadow-[0px_16px_32px_-1px_rgba(12,12,13,0.1)] outline-none focus:outline-none",side:"top",align:"center",sideOffset:26,children:(0,n.jsxs)("div",{className:"flex flex-col items-end justify-center gap-3 rounded-[10px] border border-black/3 bg-[#2C2C2C] p-3",children:[(0,n.jsx)("div",{className:"flex w-[350px] items-stretch gap-2",children:(0,n.jsx)("span",{className:"flex-1 text-[14px] leading-[1.2] tracking-[-0.04em] text-white/95",children:"AI APP consume credits from your balance during use."})}),(0,n.jsx)("span",{className:"cursor-pointer text-[14px] leading-[1.2] font-bold tracking-[-0.04em] text-white/95",onClick:()=>{l(!1)},children:"Got it"})]})})]})},W=e=>{let{project:t,onCommentClick:r,isSelected:a=!1}=e,{track:o}=(0,h.s)(),c=(0,s.useCallback)(()=>{r()},[t.project_url,r]);return(0,n.jsxs)("button",{className:(0,b.cn)("flex h-8 cursor-pointer items-center justify-center gap-1 rounded-[10px] px-2 hover:bg-black/6",a?"bg-black/6":"bg-black/3"),onClick:e=>{e.stopPropagation(),e.preventDefault(),c()},children:[(0,n.jsx)(l.Z0O,{className:"h-[14px] w-[14px] text-black/95"}),(0,n.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,M.Z)(t.comment_count||0)})]})};var Y=r(66766),q=r(68236);function J(e){var t;let{project:r,onEmojiClick:l}=e,a=(0,s.useMemo)(()=>{var e,t;return null!==(t=null===(e=r.interaction)||void 0===e?void 0:e.count.reduce((e,t)=>e+t.count,0))&&void 0!==t?t:0},[r.interaction]),{emojis:o}=(0,T.k)(),c=e=>{var t,n;return(null===(n=r.interaction)||void 0===n?void 0:null===(t=n.status.find(t=>t.interaction_type===e))||void 0===t?void 0:t.status)===!0};return(0,n.jsxs)(R.rI,{triggerType:"hover",children:[(0,n.jsx)(R.ty,{children:(0,n.jsxs)("button",{className:"flex h-8 cursor-pointer items-center justify-center gap-1 rounded-[10px] bg-black/[0.03] px-2 py-2.5 hover:bg-black/6",children:[(0,n.jsx)(Y.default,{src:q.A,alt:"emoji reaction count",className:"h-3.5 w-6"}),(0,n.jsx)("span",{className:"text-sm leading-[1.2] text-black/95",children:(0,M.Z)(a)})]})}),(0,n.jsx)(R.SQ,{className:"bottom-10 left-1/2 w-20 -translate-x-1/2 p-1",children:(0,n.jsx)("div",{className:"flex flex-col gap-1",children:null===(t=r.interaction)||void 0===t?void 0:t.count.map(e=>{let t=o.find(t=>t.interaction_type===e.interaction_type);return t?(0,n.jsxs)("div",{className:(0,b.cn)("flex h-8 cursor-pointer items-center gap-1 rounded-[8px] px-2 py-1.5 transition-colors",c(e.interaction_type)?"bg-lime-700/10":"bg-white/3 hover:bg-black/6"),onClick:t=>{t.stopPropagation(),t.preventDefault(),null==l||l(e.interaction_type)},children:[(0,n.jsx)(P.m,{emoji:t,className:"h-5 w-5 flex-shrink-0",width:20,height:20,triggerType:P.Z.Click,selected:c(e.interaction_type)}),(0,n.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,M.Z)(e.count)})]},e.interaction_type):null})})})]})}var K=r(6874),$=r.n(K),V=r(80878);let B=()=>{try{let e=localStorage.getItem(A.Hx);return e?JSON.parse(e):[]}catch(e){return[]}},G=e=>{try{let t=B();t.includes(e)||(t.push(e),localStorage.setItem(A.Hx,JSON.stringify(t)))}catch(e){}},Q=e=>{var t,r;let{project:a}=e,[o,c]=(0,s.useState)((null===(t=a.community_info)||void 0===t?void 0:t.is_favorited)||!1),[i,d]=(0,s.useState)((null===(r=a.community_info)||void 0===r?void 0:r.favorite_count)||0),[u,p]=(0,s.useState)(!1),x=(0,s.useRef)(null),{user:m}=(0,_.A)(),{checkAuth:f}=(0,y.M)(),{track:b}=(0,h.s)();(0,s.useEffect)(()=>()=>{x.current&&clearTimeout(x.current)},[]),(0,s.useEffect)(()=>{if(!u)return;let e=()=>{setTimeout(()=>{let e=document.activeElement;e&&"IFRAME"===e.tagName&&(p(!1),x.current&&(clearTimeout(x.current),x.current=null))},100)},t=()=>{p(!1),x.current&&(clearTimeout(x.current),x.current=null)};window.addEventListener("blur",e);let r=document.querySelectorAll("iframe");return r.forEach(e=>{e.addEventListener("focus",t)}),()=>{window.removeEventListener("blur",e),r.forEach(e=>{e.removeEventListener("focus",t)})}},[u]);let j=(0,s.useCallback)(e=>{p(e),!e&&x.current&&(clearTimeout(x.current),x.current=null)},[]),g=(0,s.useCallback)(async()=>{let e=!o,t=e?i+1:i-1;return b("app_page_save_button_click",{action:o?"false":"true",project_id:a.project_id,project_url:a.project_url,location:"app_page",count:t}),f(async()=>{c(e),d(t);let r=o?"cancel":"add";"add"===r&&m&&(p(!0),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{p(!1),x.current=null},4e3));try{var n;let e=await (0,V.s)(a.project_id,r);(null===(n=e.data)||void 0===n?void 0:n.status)&&m&&"add"===r&&G(m.uid)}catch(t){console.error("Failed to favorite project:",t),c(o),d(i),p(!1),x.current&&(clearTimeout(x.current),x.current=null),(0,v.P)({message:e?"Couldn't save project. Please check your network and try again.":"Couldn't unsave project. Please check your network and try again.",type:"error"})}},{title:"Want to save this project?",description:"Log in to save it and come back anytime.",cancelText:"Cancel",confirmText:"Log in"})()},[m,o,i,a.project_id,a.project_url,b]);return(0,n.jsxs)(D,{open:u,onOpenChange:j,children:[(0,n.jsx)(U,{asChild:!0,children:(0,n.jsxs)("button",{className:"flex h-8 cursor-pointer items-center justify-center gap-1 rounded-[10px] bg-black/3 px-2 hover:bg-black/6",onClick:e=>{e.stopPropagation(),e.preventDefault(),g()},children:[o?(0,n.jsx)(l.H9m,{className:"h-[14px] w-[14px]",style:{color:"rgba(255, 201, 55, 0.95)"}}):(0,n.jsx)(l.YSf,{className:"h-[14px] w-[14px] text-black/95"}),(0,n.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,M.Z)(i)})]})}),(0,n.jsx)(O,{className:"w-auto translate-x-[-40px] rounded-[10px] p-0 shadow-[0px_16px_48px_1px_rgba(12,12,13,0.1)]",side:"top",align:"center",sideOffset:16,children:(0,n.jsxs)("div",{className:"flex items-center justify-center gap-1 rounded-[10px] bg-[#2C2C2C] py-1 pr-1 pl-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"flex h-4 w-4 items-center justify-center",children:(0,n.jsx)(l.Jnp,{className:"h-[14.6px] w-[14.6px] text-[#14AE5C]"})}),(0,n.jsx)("span",{className:"text-[14px] leading-[15.68px] font-normal tracking-[-0.03em] text-white/95",children:"Saved successfully！"})]}),(0,n.jsx)("div",{className:"h-[10px] w-px bg-white/15"}),(0,n.jsx)($(),{href:"/profile/".concat(null==m?void 0:m.uid,"?tab=saved"),target:"_blank",className:"flex h-8 items-center justify-center rounded-lg px-2 text-[14px] font-bold text-white/95",children:"View list"})]})})]})};function X(e){var t;let{project:r,handleFullScreen:o,handleReport:c,onUpdate:i,onRoll:d,rolling:u,onShareClick:p,onCommentClick:x,isCommentPanelOpen:m=!1}=e,{emojis:f,registerInteractionCallback:v,interact:j}=(0,T.k)(),[g,w]=(0,s.useState)(null),[_,y]=(0,s.useState)(!1),{track:k}=(0,h.s)(),S=(0,a.useRouter)(),{remixAction:P,isRemixing:F}=(0,I.N)(),D=(null===(t=r.user)||void 0===t?void 0:t.uid)===A.v1,U=e=>{if(m)return e.preventDefault(),e.stopPropagation(),!1};(0,s.useEffect)(()=>{S.prefetch((0,C.$)())},[]),(0,s.useEffect)(()=>{v(r.project_id,(e,t)=>{i(r,t)})},[r.project_id,v]),(0,s.useEffect)(()=>{_&&w(window.innerWidth<=640)},[_]),(0,s.useEffect)(()=>{y(!0)},[]);let O=e=>{var t,n,l,a;let s=null===(n=r.interaction)||void 0===n?void 0:null===(t=n.status.find(t=>t.interaction_type===e))||void 0===t?void 0:t.status;j(r,e,s?E.f.Cancel:E.f.Add),k("emoji_reaction_click",{action:s?"false":"true",project_id:r.project_id,project_url:r.project_url,emoji:e,location:"app_page",count:((null===(a=r.interaction)||void 0===a?void 0:null===(l=a.count.find(t=>t.interaction_type===e))||void 0===l?void 0:l.count)||0)+(s?-1:1)})},z=(0,s.useCallback)(async()=>{if(!r.allow_remix){(0,N.S)({title:"Remix Not Supported",description:"This project doesn't allow remixing",confirmText:"Got it",onConfirm:()=>{}});return}k("remix_button_click",{origin_project_id:r.project_id,origin_project_url:r.project_url,remix_count:r.remix_count,location:"app_page",access_control:r.allow_remix?"allowed":"not_allowed"}),await P(r.project_id,"remix")},[P]),H=()=>(0,n.jsx)("button",{className:(0,b.cn)("flex h-8 w-8 cursor-pointer items-center justify-center rounded-[10px] bg-black/[0.03] hover:bg-black/6",m&&"pointer-events-none cursor-not-allowed opacity-50"),onClick:e=>{if(m){U(e);return}p()},children:(0,n.jsx)(l.d6X,{className:"h-[14px] w-[14px] text-black/95"})}),Y=()=>(0,n.jsx)("div",{className:"h-[16px] w-[1px] bg-black/6"});return _&&null!==g?(0,n.jsxs)("div",{className:(0,b.cn)("bg-body flex h-12 w-full max-w-full flex-row items-center justify-between gap-4 overflow-visible px-4",g&&"h-[72px] border-t border-black/6"),children:[(0,n.jsxs)("div",{id:"left-container",className:"flex flex-1 shrink-0 flex-row items-center gap-2",children:[(0,n.jsxs)("a",{id:"logo-container",className:(0,b.cn)("flex cursor-pointer flex-row items-center gap-1",m&&"pointer-events-none cursor-not-allowed opacity-50"),onClick:e=>{if(m){U(e);return}k("app_watermark_button_click",{project_id:r.project_id,project_url:r.project_url}),S.push((0,C.$)())},children:[(0,n.jsx)("img",{src:"/icons/logo.svg",alt:"Logo",className:"text-brand h-6 w-6"}),(0,n.jsx)("div",{className:"hidden text-base leading-5 text-black/95 sm:block",children:"YouWare"})]}),!D&&Y(),!D&&(()=>{var e,t;let l=(0,C.$)();return(0,n.jsxs)("div",{id:"user-container",className:(0,b.cn)("flex cursor-pointer flex-row items-center gap-2",m&&"pointer-events-none cursor-not-allowed opacity-50"),onClick:e=>{var t;if(m){U(e);return}S.push("".concat(l,"/profile/").concat(null===(t=r.user)||void 0===t?void 0:t.uid)),k("app_creator_info_click",{project_id:r.project_id,project_url:r.project_url})},children:[(0,n.jsx)("img",{src:(null===(e=r.user)||void 0===e?void 0:e.photo_url)||"/images/avatar.svg",alt:"",className:"h-5 w-5 rounded-full bg-gray-200 object-cover"}),!g&&(0,n.jsx)("div",{className:"hidden text-sm font-medium text-black/95 sm:block",children:null===(t=r.user)||void 0===t?void 0:t.display_name})]})})()]}),(0,n.jsx)("div",{className:(0,b.cn)("hover:bg-brand border-brand text-brand absolute left-1/2 z-10 flex h-[36px] w-[86px] -translate-x-1/2 transform cursor-pointer items-center justify-center rounded-[12px] border hover:text-white",u&&"bg-brand text-white",g&&"bg-brand h-[48px] w-[96px] rounded-[16px] border-none text-white shadow-[0px_8px_20px_0px_rgba(55,67,45,0.30)] active:bg-[#44503B] active:shadow-none",m&&"pointer-events-none cursor-not-allowed opacity-50"),onClick:e=>{if(m){U(e);return}d(r)},children:(0,n.jsx)("div",{className:"flex items-center gap-1",children:u?(0,n.jsx)(L.A,{style:{width:g?"28px":"20px",height:g?"28px":"20px"},animationPath:"/animations/lottie-roll-project.json"}):(0,n.jsx)(l.OB8,{className:(0,b.cn)("h-5 w-5",g&&"h-[28px] w-[28px]")})})}),(0,n.jsxs)("div",{className:"flex min-w-0 flex-1 items-center justify-end gap-2",children:[!D&&g&&(0,n.jsxs)("div",{className:"ml-auto flex shrink-0 items-center gap-2",children:[(0,n.jsx)(W,{project:r,onCommentClick:x,isSelected:m}),H()]}),!g&&(0,n.jsxs)("div",{className:"flex shrink-0 items-center gap-2",children:[r.is_ai_app&&(0,n.jsx)(Z,{project:r}),(0,n.jsxs)("div",{className:"flex h-8 items-center justify-center gap-1 rounded-[10px]",children:[(0,n.jsx)(l.tLq,{className:"h-[14px] w-[14px] text-black/95"}),(0,n.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,M.Z)(r.view_count||0)})]}),Y(),!D&&(0,n.jsx)("div",{className:(0,b.cn)("relative",m&&"pointer-events-none opacity-50"),onClick:U,children:(0,n.jsx)(J,{project:r,onEmojiClick:e=>{O(e)}})}),(0,n.jsx)("div",{className:(0,b.cn)("relative",m&&"pointer-events-none opacity-50"),onClick:U,children:(0,n.jsx)(Q,{project:r},r.project_id)}),(0,n.jsx)(W,{project:r,onCommentClick:x,isSelected:m}),H(),(0,n.jsx)("div",{className:(0,b.cn)("relative",m&&"pointer-events-none opacity-50"),children:(0,n.jsxs)(R.rI,{triggerType:"hover",children:[(0,n.jsx)(R.ty,{className:"flex h-8 w-8 cursor-pointer items-center justify-center rounded-[10px] bg-black/3 hover:bg-black/6",children:(0,n.jsx)(l.aWm,{className:"h-[14px] w-[14px]",color:"black"})}),(0,n.jsxs)(R.SQ,{className:"right-0 bottom-10 w-[148px]",children:[(0,n.jsx)(R._2,{icon:l.nHt,label:"Full Screen",onClick:o}),!D&&(0,n.jsx)(R._2,{disabled:F||!r.allow_remix,icon:F?l.xNY:l.xP3,label:"Remix",onClick:z}),(0,n.jsx)(R._2,{icon:l.qGO,label:"Report",onClick:c})]})]})})]})]})]}):(0,n.jsx)("div",{className:(0,b.cn)("flex h-12 w-full max-w-full flex-row items-center justify-between gap-4 px-4",g&&"px-6")})}let ee=(0,o.createServerReference)("405013438e102f19575870024c7002b7f73104aff3",o.callServer,void 0,o.findSourceMapURL,"createComment"),et=(0,o.createServerReference)("40475d54df6e479bb0cd716288cc01cf7330e46628",o.callServer,void 0,o.findSourceMapURL,"deleteComment");var er=r(62128);function en(e){let{onSubmit:t,allowShiftEnter:r=!1}=e,[n,l]=(0,s.useState)(""),[a,o]=(0,s.useState)(0),[c,i]=(0,s.useState)(!1),[d,u]=(0,s.useState)(""),{checkAuth:p}=(0,y.M)(),x=e=>{let t=0;for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);n>=19968&&n<=40959||n>=12352&&n<=12447||n>=12448&&n<=12543||n>=44032&&n<=55215||n>=126976&&n<=129535?t+=2:t+=1}return t},m=async()=>{if(n.trim()&&!(a>5e3)&&!c){i(!0);try{await t(n),l(""),o(0),u("")}catch(e){(0,v.P)({message:e.message||"Failed to post comment. Please try again.",type:"error"})}finally{i(!1)}}};return{content:n,charCount:a,isSubmitting:c,errorMessage:d,MAX_CHAR_COUNT:5e3,handleChange:e=>p(async()=>{let t=e.target.value,r=x(t);r<=5e3?(l(t),o(r),u("")):u("Character limit exceeded. Maximum ".concat(5e3," characters allowed."))},{title:"Want to leave a comment?",description:"Log in to join the conversation and share your thoughts.",cancelText:"Cancel",confirmText:"Log in"})(),handleSubmit:m,handleKeyDown:e=>{"Enter"===e.key&&!e.nativeEvent.isComposing&&(!r||!e.metaKey&&!e.shiftKey)&&(e.preventDefault(),m())},resetForm:()=>{l(""),o(0),u("")}}}function el(e){let{project:t,onSubmit:r,replyTo:a,shouldFocus:o,onFocused:c,onCancelReply:i,onCancelReplyComment:d}=e,u=(0,s.useRef)(null),{content:p,charCount:x,isSubmitting:m,errorMessage:f,MAX_CHAR_COUNT:h,handleChange:v,handleSubmit:j,handleKeyDown:g,resetForm:w}=en({onSubmit:r,allowShiftEnter:!0});return(0,s.useEffect)(()=>{if(u.current){let e=u.current;e.style.overflowY="hidden",e.style.height="auto";let t=Math.min(e.scrollHeight,104);e.style.height="".concat(t,"px"),e.scrollHeight>104&&(e.style.overflowY="auto")}},[p]),(0,s.useEffect)(()=>{o&&u.current&&(u.current.focus(),null==c||c())},[o,c]),(0,n.jsxs)("div",{className:(0,b.cn)("flex flex-col p-4",a&&"border-t border-black/6"),children:[a&&(0,n.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-2 pr-0 pl-2",children:[(0,n.jsxs)("div",{className:"flex flex-col items-start gap-0.5",children:[(0,n.jsxs)("span",{className:"text-xs text-black/30",children:["Reply to ",a.user.display_name,":"]}),(0,n.jsx)("span",{className:"text-sm text-black/65",children:a.comment})]}),(0,n.jsx)("button",{className:"h-6 w-6 text-xs text-black/95",onClick:()=>null==d?void 0:d(),children:(0,n.jsx)(l.Qks,{className:"h-4 w-4"})})]}),(0,n.jsx)("textarea",{id:"comment-input",ref:u,className:"max-h-[104px] w-full resize-none rounded-[10px] border border-black/6 bg-white px-3 py-[10px] text-sm outline-none focus:border-black/65",placeholder:a?"":"Join the conversation",value:p,onChange:v,onKeyDown:g,rows:1}),f&&(0,n.jsx)("p",{className:"mt-2 w-full overflow-hidden text-xs break-words text-[#D42727]",children:f}),(0,n.jsxs)("div",{className:"mt-3 flex justify-end gap-3",children:[(0,n.jsx)("button",{className:"h-8 w-17 cursor-pointer rounded-[10px] border border-black/3 px-[10px] text-sm hover:border-transparent hover:bg-black/3 disabled:cursor-not-allowed",onClick:i||w,disabled:m,children:"Cancel"}),(0,n.jsxs)("button",{className:(0,b.cn)("bg-brand flex h-8 cursor-pointer items-center gap-2 rounded-[10px] px-[10px] text-sm text-white",(!p.trim()||x>h||m)&&"cursor-not-allowed opacity-30"),onClick:j,disabled:!p.trim()||x>h||m,children:[m&&(0,n.jsx)(l.xNY,{className:"h-4 w-4 animate-spin"}),"Comment"]})]})]})}let ea=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.floor(Date.now()/1e3),r=t-e;return r<60?"".concat(r,"s ago"):r<3600?"".concat(Math.floor(r/60),"m ago"):r<86400?"".concat(Math.floor(r/3600),"h ago"):"".concat(Math.floor(r/86400),"d ago")},es=e=>{let t=/(https?:\/\/[^\s]+)/g;return e.split(t).map((e,r)=>t.test(e)?(0,n.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"pointer-events-auto cursor-pointer break-all text-[#0077FF] hover:underline",children:e},r):e)};function eo(e){var t,r,a,o;let{comment:c,currentUserId:i,projectAuthorId:d,onReply:u,onDelete:p,isHighlighted:x=!1}=e,m=c.user.uid===i,f=c.user.uid===d,h=(0,s.useRef)(null),v=(0,s.useMemo)(()=>ea(c.create_time),[c.create_time]);return(0,n.jsx)("div",{ref:h,className:(0,b.cn)("rounded-xl p-2",x&&"bg-[#5581340F]"),children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsxs)("div",{className:"group relative mt-0.5 h-[30px] w-[30px] shrink-0 cursor-pointer rounded-full",onClick:()=>window.open("/profile/".concat(c.user.uid),"_blank"),children:[(0,n.jsx)("img",{src:c.user.photo_url||"/images/avatar.svg",alt:"",className:"h-full w-full rounded-full"}),(0,n.jsx)("div",{className:"absolute inset-0 rounded-full bg-black/6 opacity-0 transition-opacity duration-200 group-hover:opacity-100"})]}),(0,n.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,n.jsx)("span",{className:"w-fit cursor-pointer text-xs text-black/65 hover:text-black/95",onClick:()=>window.open("/profile/".concat(c.user.uid),"_blank"),children:c.user.display_name}),(null===(t=c.user.badge)||void 0===t?void 0:t.value)&&(0,n.jsx)("span",{className:"h-4 rounded-full px-[5px] text-[10px] leading-[16px] font-bold",style:{backgroundColor:(null===(r=c.user.badge)||void 0===r?void 0:r.bg_color)||"#EBECE9",color:(null===(a=c.user.badge)||void 0===a?void 0:a.text_color)||"#55644A"},children:(null===(o=c.user.badge)||void 0===o?void 0:o.value)||""}),f&&(0,n.jsx)("span",{className:"h-4 rounded-full bg-[#EDEEF0] px-[5px] text-[10px] leading-[16px] font-bold text-[#475569]",children:"Creator"})]}),(0,n.jsxs)("div",{className:"mt-[2px] text-sm break-words text-black/95",children:[c.reply_user&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-black/65",children:"Reply to "}),(0,n.jsx)("button",{className:"cursor-pointer font-bold text-black/95 hover:underline",onClick:()=>window.open("/profile/".concat(c.reply_user.uid),"_blank"),children:c.reply_user.display_name}),(0,n.jsx)("span",{className:"text-black/65",children:": "})]}),(0,n.jsx)("div",{className:(0,b.cn)("w-full max-w-none overflow-hidden text-sm [word-break:break-word] whitespace-pre-line",c.reply_user&&"inline"),children:es(c.comment)})]}),(0,n.jsxs)("div",{className:"mt-[7.5px] flex items-center gap-2 text-xs text-black/30",children:[(0,n.jsx)("span",{children:v}),(0,n.jsx)("div",{className:"h-2 w-px bg-black/6"}),(0,n.jsx)("span",{className:"cursor-pointer rounded-lg px-1.5 py-1 text-black/65 hover:bg-black/3",onClick:()=>u(c),children:"Reply"})]})]}),m&&(0,n.jsxs)(R.rI,{triggerType:"click",children:[(0,n.jsx)(R.ty,{children:(0,n.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-lg hover:bg-black/3",children:(0,n.jsx)(l.BlR,{className:"h-4 w-4 cursor-pointer text-black/95"})})}),(0,n.jsx)(R.SQ,{className:(0,b.cn)("top-8 right-0 w-28"),children:(0,n.jsx)(R._2,{icon:l.WFf,label:"Delete",onClick:()=>p(c)})})]})]})})}function ec(e){var t;let{project:r}=e,a=(null===(t=r.user)||void 0===t?void 0:t.uid)===A.v1,{interact:s}=(0,T.k)(),{track:o}=(0,h.s)(),c=e=>{var t,n,l,a;let c=null===(n=r.interaction)||void 0===n?void 0:null===(t=n.status.find(t=>t.interaction_type===e))||void 0===t?void 0:t.status;s(r,e,c?E.f.Cancel:E.f.Add),o("emoji_reaction_click",{action:c?"false":"true",project_id:r.project_id,project_url:r.project_url,emoji:e,location:"app_page",count:((null===(a=r.interaction)||void 0===a?void 0:null===(l=a.count.find(t=>t.interaction_type===e))||void 0===l?void 0:l.count)||0)+(c?-1:1)})};return(0,n.jsx)("div",{className:"flex flex-col border-t border-black/6 p-4",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[(0,n.jsxs)("div",{className:"flex h-8 items-center justify-center gap-1 rounded-[10px]",children:[(0,n.jsx)(l.tLq,{className:"h-[14px] w-[14px] text-black/95"}),(0,n.jsx)("span",{className:"text-sm font-normal text-black/95",children:(0,M.Z)(r.view_count||0)})]}),(0,n.jsxs)("div",{className:"flex h-8 items-center justify-center gap-2",children:[!a&&(0,n.jsx)(J,{project:r,onEmojiClick:e=>{c(e)}}),(0,n.jsx)(Q,{project:r})]})]})})}var ei=r(47650);function ed(e){let{project:t,onSubmit:r,replyTo:a,onCancel:o}=e,[c,i]=(0,s.useState)(!1),d=(0,s.useRef)(null),{content:u,charCount:p,isSubmitting:x,errorMessage:m,MAX_CHAR_COUNT:f,handleChange:h,handleSubmit:v,handleKeyDown:j,resetForm:g}=en({onSubmit:r,allowShiftEnter:!1});if((0,s.useEffect)(()=>{i(!0)},[]),(0,s.useEffect)(()=>{d.current&&(d.current.style.height="auto",d.current.style.height="".concat(d.current.scrollHeight,"px"))},[u]),!c)return null;let w=(0,n.jsx)("div",{className:"fixed inset-0 z-[50] flex items-center justify-center bg-black/20 px-4 sm:hidden",onClick:e=>{e.target===e.currentTarget&&o&&o()},children:(0,n.jsxs)("div",{className:"flex w-full max-w-md flex-col overflow-hidden rounded-2xl bg-white p-4 shadow-[0px_16px_48px_1px_rgba(0,0,0,0.2)]",children:[a&&(0,n.jsx)("div",{className:"mb-3 flex w-full items-start justify-between gap-2 pr-0 pl-2",children:(0,n.jsxs)("div",{className:"flex flex-col items-start gap-0.5",children:[(0,n.jsxs)("span",{className:"text-xs text-black/30",children:["Reply to ",a.user.display_name,":"]}),(0,n.jsx)("span",{className:"text-sm text-black/65",children:a.comment})]})}),(0,n.jsx)("textarea",{id:"comment-input",ref:d,className:"max-h-[104px] w-full resize-none rounded-[10px] border border-black/6 bg-white px-3 py-[10px] text-sm outline-none focus:border-black/65",value:u,onChange:h,onKeyDown:j,autoFocus:!0,rows:1}),m&&(0,n.jsx)("p",{className:"mt-2 w-full overflow-hidden text-xs break-words text-[#D42727]",children:m}),(0,n.jsxs)("div",{className:"mt-3 flex w-full justify-end gap-3",children:[(0,n.jsx)("button",{className:"h-8 w-17 cursor-pointer rounded-[10px] border border-black/3 px-[10px] text-sm hover:border-transparent hover:bg-black/3 disabled:cursor-not-allowed",onClick:o||g,disabled:x,children:"Cancel"}),(0,n.jsxs)("button",{className:(0,b.cn)("bg-brand flex h-8 cursor-pointer items-center gap-2 rounded-[10px] px-[10px] text-sm text-white",(!u.trim()||p>f||x)&&"cursor-not-allowed opacity-30"),onClick:v,disabled:!u.trim()||p>f||x,children:[x&&(0,n.jsx)(l.xNY,{className:"h-4 w-4 animate-spin"}),"Comment"]})]})]})});return(0,ei.createPortal)(w,document.body)}function eu(e){let{project:t,onSubmit:r,replyTo:l,onCancelReply:a}=e,o=(0,s.useRef)(null),{user:c}=(0,_.A)(),{content:i,handleChange:d,handleKeyDown:u}=en({onSubmit:r,allowShiftEnter:!1});return(0,n.jsxs)("div",{className:"flex flex-col p-4",children:[(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-3",children:[(0,n.jsx)("div",{className:"mt-0.5 h-[30px] w-[30px] cursor-pointer rounded-full bg-cover bg-center",style:{backgroundImage:"url(".concat((null==c?void 0:c.photo_url)||"/images/avatar.svg","), url('/images/avatar.svg')")},onClick:()=>window.open("/profile/".concat(null==c?void 0:c.uid),"_blank")}),(0,n.jsx)("textarea",{id:"comment-input",ref:o,className:"flex-1 resize-none rounded-[10px] border border-black/6 bg-white px-3 py-[10px] text-sm outline-none focus:border-black/20",placeholder:"Add comment...",value:i,onChange:d,onKeyDown:u,rows:1,enterKeyHint:"send"})]}),l&&(0,n.jsx)(ed,{project:t,onSubmit:r,replyTo:l,onCancel:()=>{null==a||a()}})]})}function ep(e){let{project:t,isOpen:r,onClose:a,anchorCommentId:o,onCommentCountChange:c}=e,[d,u]=(0,s.useState)([]),[p,x]=(0,s.useState)(!0),[m,f]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),[g,w]=(0,s.useState)(void 0),[k,S]=(0,s.useState)(null),[C,E]=(0,s.useState)(t.comment_count||0),[R,T]=(0,s.useState)(o||""),[P,L]=(0,s.useState)([]),[A,I]=(0,s.useState)(null),[M,F]=(0,s.useState)(!1),{user:D}=(0,_.A)(),{track:U}=(0,h.s)(),O=(0,s.useRef)(null),z=(0,s.useRef)(null),H=(0,s.useRef)(null),Z=(0,s.useRef)(null),{checkAuth:W}=(0,y.M)();(0,s.useEffect)(()=>(r&&(J(),document.body.style.overflow="hidden",U("app_comment_panel_show",{project_id:t.project_id,project_url:t.project_url,comments_num:C})),()=>{document.body.style.overflow="auto"}),[r]);let Y=e=>{let t=new Set;return e.filter(e=>!t.has(e.uuid)&&(t.add(e.uuid),!0))},q=()=>{o&&R&&(Z.current&&clearTimeout(Z.current),Z.current=setTimeout(()=>{T("")},3e3))};(0,s.useEffect)(()=>()=>{Z.current&&clearTimeout(Z.current)},[]);let J=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e||0===d.length?x(!0):f(!0);let l=await i({project_id:t.project_id,order:"asc",cursor:e?"":g||"",page_size:15,anchor_comment_id:o});if(0===l.code&&l.data){var r,n;let t=l.data.comments||[];u(r=>e?Y(t):Y([...r,...t])),null==c||c(l.data.total||0),E(l.data.total||0),I(l.data.anchor_comment||null),j((null===(r=l.data.page_info)||void 0===r?void 0:r.has_more)||!1),w(null===(n=l.data.page_info)||void 0===n?void 0:n.cursor)}}catch(e){er.vF.error("Failed to fetch comments:",e)}finally{x(!1),f(!1),q()}};(0,s.useEffect)(()=>{if(z.current&&z.current.disconnect(),!H.current||!v||p||m)return;let e=new IntersectionObserver(e=>{e[0].isIntersecting&&!p&&!m&&v&&J()},{root:O.current,rootMargin:"300px",threshold:.2});return e.observe(H.current),z.current=e,()=>{z.current&&z.current.disconnect()}},[p,m,v]);let K=async e=>{let r=await ee({project_id:t.project_id,comment_text:e,reply_comment_id:null==k?void 0:k.uuid});if(0===r.code&&r.data){let n=r.data,l=Math.max(C+1,0);L(e=>[n,...e]),null==c||c(l),E(l),S(null),U("app_comment_sent",{project_id:t.project_id,project_url:t.project_url,comments_num:l,comment_detail:e,reply_detail:null==k?void 0:k.comment}),O.current&&O.current.scrollTo({top:0,behavior:"smooth"})}else throw Error(r.message||"Failed to create comment")},$=async e=>{(0,N.S)({title:"Delete this comment?",description:"This action can't be undone.",confirmText:"Delete",cancelText:"Cancel",onCancel:()=>{},onConfirm:async()=>{try{let r=await et({project_id:t.project_id,comment_id:e.uuid});if(0===r.code){u(t=>t.filter(t=>t.uuid!==e.uuid)),L(t=>t.filter(t=>t.uuid!==e.uuid)),e.uuid===o&&I(null);let r=Math.max(C-1,0);null==c||c(r),E(r),U("app_comment_delete",{project_id:t.project_id,project_url:t.project_url,comment_detail:e.comment,comments_num:r})}}catch(e){er.vF.error("Failed to delete comment:",e)}},confirmClassName:"bg-[#D42727]! hover:bg-[#D42727]/85!"})},V=e=>W(async()=>{S(e),F(!0)},{title:"Want to leave a comment?",description:"Log in to join the conversation and share your thoughts.",cancelText:"Cancel",confirmText:"Log in"})();return(0,n.jsxs)(n.Fragment,{children:[r&&(0,n.jsx)("div",{className:"fixed inset-0 z-[49] bg-black/20 sm:bg-transparent",onClick:a}),(0,n.jsxs)("div",{className:(0,b.cn)("fixed z-50 flex flex-col overflow-hidden rounded-2xl bg-white shadow-[0px_16px_48px_1px_rgba(0,0,0,0.2)] transition-transform duration-300","sm:top-2 sm:right-2 sm:bottom-[48px] sm:h-[calc(100vh-48px-8px)] sm:w-[400px]","max-sm:right-0 max-sm:bottom-0 max-sm:left-0 max-sm:h-[80vh] max-sm:w-full max-sm:rounded-t-lg max-sm:rounded-b-none",r?"translate-x-0 translate-y-0":"max-sm:translate-y-full sm:translate-x-[calc(100%+8px)]"),children:[(0,n.jsx)("div",{className:"mt-2 flex items-center justify-between px-5 py-2",children:(0,n.jsx)("h3",{className:"text-base font-bold text-black/95",children:1===C?"1 Comment":"".concat(C," Comments")})}),(0,n.jsx)("div",{className:"block sm:hidden",children:(0,n.jsx)(eu,{project:t,onSubmit:K,replyTo:k,onCancelReply:()=>{S(null)}})}),(0,n.jsx)("div",{className:"hidden border-b border-black/6 sm:block"}),(0,n.jsxs)("div",{ref:O,className:"flex-1 overflow-y-auto p-2",children:[p&&0===d.length&&(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsx)(l.xNY,{className:"h-6 w-6 animate-spin text-black/30"})})}),!p&&0===d.length&&0===P.length&&(0,n.jsxs)("div",{className:"flex h-full flex-col items-center justify-center px-[60px] text-black/65",children:[(0,n.jsx)(l.My6,{className:"mb-3 h-8 w-8 text-black/12"}),(0,n.jsx)("p",{className:"mb-1 text-sm font-bold text-black/95",children:"Be the first to comment"}),(0,n.jsx)("p",{className:"text-center text-xs text-black/65",children:"Add your voice and let the creator hear from you."})]}),(d.length>0||P.length>0||o)&&(0,n.jsxs)(n.Fragment,{children:[(()=>{let e=new Set(P.map(e=>e.uuid)),t=null==A?void 0:A.uuid,r=d.filter(r=>!e.has(r.uuid)&&r.uuid!==t);return[...[...P].sort((e,t)=>new Date(t.create_time).getTime()-new Date(e.create_time).getTime()),...A?[A]:[],...r]})().map((e,r)=>{var l;return(0,n.jsx)(eo,{comment:e,currentUserId:(null==D?void 0:D.uid)||"",projectAuthorId:(null===(l=t.user)||void 0===l?void 0:l.uid)||"",onReply:V,onDelete:$,isHighlighted:e.uuid===R},r)}),v&&(0,n.jsx)("div",{ref:H,className:"flex items-center justify-center py-4",children:m&&(0,n.jsx)(l.xNY,{className:"h-6 w-6 animate-spin text-black/30"})})]})]}),(0,n.jsx)("div",{className:"hidden sm:block",children:(0,n.jsx)(el,{project:t,onSubmit:K,replyTo:k,shouldFocus:M,onFocused:()=>{F(!1)},onCancelReply:()=>{a()},onCancelReplyComment:()=>{S(null)}})}),(0,n.jsx)("div",{className:"block sm:hidden",children:(0,n.jsx)(ec,{project:t})})]})]})}function ex(e){let{isPlaying:t}=e;return t?(0,n.jsx)("div",{className:"absolute inset-0 z-10 flex h-full w-full items-center justify-center bg-black",children:(0,n.jsx)(L.A,{animationPath:"/animations/lottie-roll-project-mask.json",className:"aspect-square h-[70%] items-center justify-center opacity-30",style:{pointerEvents:"none"}})}):null}var em=r(42334),ef=r(47835),eh=r(25827);function ev(e){let{subdomain:t,onVerificationSuccess:r}=e,[a,o]=(0,s.useState)(["","","",""]),[c,i]=(0,s.useState)("idle"),[d,u]=(0,s.useState)(""),{track:p}=(0,h.s)();(0,s.useEffect)(()=>{p("verify_passcode_page_show",{project_url:window.location.pathname})},[]);let x=(0,s.useRef)([]);(0,s.useEffect)(()=>{x.current[0]&&x.current[0].focus()},[]);let m=(e,t)=>{if("Backspace"===e.key&&!a[t]&&t>0){var r;null===(r=x.current[t-1])||void 0===r||r.focus()}},f=(0,em.nF)({interval:200},(e,t)=>{let r=e.target.value.slice(-1);if(""===r||/^[0-9a-zA-Z]$/.test(r)){let e=[...a];if(e[t]=r,o(e),""!==r&&t<3){var n;null===(n=x.current[t+1])||void 0===n||n.focus()}""!==r&&3===t&&e.every(e=>""!==e)&&b(e.join(""))}}),v=e=>{e.preventDefault();let t=e.clipboardData.getData("text");if(/^[0-9a-zA-Z]+$/.test(t)){var r,n;let e=t.split(""),l=[...a];for(let t=0;t<Math.min(4,e.length);t++)l[t]=e[t];if(o(l),l.every(e=>""!==e))null===(r=x.current[3])||void 0===r||r.focus(),b(l.join(""));else{let e=l.findIndex(e=>""===e);-1!==e&&(null===(n=x.current[e])||void 0===n||n.focus())}}},b=async e=>{i("pending");try{let n=await (0,ef.a)(t,e);(null==n?void 0:n.verified)&&(null==n?void 0:n.iframe_url)?(i("success"),p("verify_passcode_success",{project_url:window.location.pathname}),r(null==n?void 0:n.iframe_url)):(i("error"),u("Code mismatch - verify with the owner"))}catch(e){i("error"),u("Verification failed. Please try again.")}};return(0,n.jsxs)("div",{className:"min-h-screen",children:[(0,n.jsx)(eh.default,{}),(0,n.jsxs)("div",{className:"flex min-h-[calc(100vh-64px)] flex-col items-center justify-center pb-[15vh]",children:[(0,n.jsx)("h1",{className:"font-montserrat text-transform-capitalize mb-3 text-[40px] leading-[40px] font-medium",children:"Locked Project"}),(0,n.jsx)("p",{className:"",children:"A password is required to view this creation"}),(0,n.jsx)("div",{className:"my-12 flex justify-center space-x-4",children:a.map((e,t)=>(0,n.jsx)("input",{ref:e=>{x.current[t]=e},type:"text",inputMode:"text",autoComplete:"off",maxLength:1,value:e,onChange:e=>f(e,t),onKeyDown:e=>m(e,t),onPaste:0===t?v:void 0,className:"h-24 w-18 rounded-[20px] border-none text-center text-[40px] font-medium [box-shadow:12.171px_4.868px_65.722px_0px_rgba(0,0,0,0.09)] transition-all focus:outline-black",disabled:"pending"===c},t))}),(0,n.jsxs)("div",{className:"h-6 w-auto",children:["pending"===c&&(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,n.jsx)(l.xNY,{className:"h-6 w-6 animate-spin"}),(0,n.jsx)("p",{className:"text-center",children:"Verifying..."})]}),"success"===c&&(0,n.jsx)("p",{className:"text-center text-green-600",children:"✨ Access granted!"}),"error"===c&&(0,n.jsx)("p",{className:"text-center text-[#E60023]",children:d})]})]})]})}var eb=r(707);let ej=e=>({urlTitle:e.split("-").slice(0,-1).join("-"),urlHash:e.split("-").pop()||""}),eg=()=>{let e=window.location.pathname;return e.includes("/project/")?ej(e.split("/").pop()||"").urlTitle:""},ew=(0,o.createServerReference)("6094db7d95bc817cbd363649e3519d549850b71da8",o.callServer,void 0,o.findSourceMapURL,"getRandomSelectedProjects"),e_="viewed_projects",ey=()=>{try{let e=localStorage.getItem(e_);if(!e)return[];let t=JSON.parse(e),r=Date.now();return t.filter(e=>r-e.timestamp<36e5).map(e=>e.id)}catch(e){return console.error("Error getting viewed projects:",e),[]}},eN=e=>{if(e)try{let t=localStorage.getItem(e_),r=t?JSON.parse(t):[],n=Date.now(),l=r.filter(e=>n-e.timestamp<36e5),a=l.findIndex(t=>t.id===e);a>=0?l[a].timestamp=n:l.push({id:e,timestamp:n}),localStorage.setItem(e_,JSON.stringify(l))}catch(e){console.error("Error saving viewed project:",e)}},ek=()=>{let[e,t]=(0,s.useState)(!1),{checkAuth:r}=(0,y.M)(),n=async()=>{await r(async()=>{t(!0)},{title:"Want to report this project?",description:"Please log in to help keep the community safe.",cancelText:"Cancel",confirmText:"Log in"})()};return{showReportModal:e,setShowReportModal:t,handleReport:n}};function eS(e){let{projectViewDetail:t,urlHash:r,screenStatus:o,enterFrom:m,h1SEOContent:f}=e,j=(0,s.useRef)(null),[E,R]=(0,s.useState)(m),[T,P]=(0,s.useState)(t.iframe_url),[L,A]=(0,s.useState)(t.need_passcode&&!t.iframe_url),I=(0,a.useSearchParams)(),M=(0,a.useRouter)(),[F,D]=(0,s.useState)(!1),{track:U}=(0,h.s)(),{showReportModal:O,setShowReportModal:z,handleReport:H}=ek(),Z=p(),{checkAuth:W}=(0,y.M)(),{user:Y}=(0,_.A)(),{isFullScreen:q,handleFullScreen:J,disableExitFullScreen:K}=function(){let{initialState:e=!1,forceFullScreen:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[r,n]=(0,s.useState)(e);return(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r&&!t&&n(!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[r,t]),{isFullScreen:r,setIsFullScreen:n,handleFullScreen:()=>{t||n(!r)},disableExitFullScreen:t}}({initialState:"force_full"===o||"default_full"===o,forceFullScreen:"force_full"===o}),{rolling:$,project:V,handleRoll:B,handleFinishRoll:G,setProject:Q}=function(e){let{initialProject:t,isLoading:r=!1,onProjectChange:n,onUrlChange:l}=e,[a,o]=(0,s.useState)(!1),[c,i]=(0,s.useState)(0),[d,u]=(0,s.useState)(t),{track:p}=(0,h.s)(),x=(0,s.useRef)(null);(0,s.useEffect)(()=>()=>{x.current&&clearTimeout(x.current)},[]);let m=async()=>{if(a||r)return;o(!0),i(Date.now()),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{console.log("roll timeout (including API and iframe load), auto stop"),o(!1)},5e3);let e=ey();p("app_page_random_button_click",{project_id:d.project_id,project_url:d.project_url});let t=await ew(e);if(!x.current){console.log("API request completed but timeout already occurred");return}if(t.data&&t.data.projects.length>0){let e=t.data.projects[0],r={...e,need_passcode:!1};u(r),n&&n(r),l&&e.iframe_url&&l(e.iframe_url),e.project_id&&eN(e.project_id)}else o(!1),x.current&&(clearTimeout(x.current),x.current=null)};return{rolling:a,project:d,handleRoll:m,handleFinishRoll:()=>{let e=Date.now()-c;if(x.current&&(clearTimeout(x.current),x.current=null),!d.project_url){o(!1),i(0);return}let t=d.project_url;e>1e3?(o(!1),window.history.pushState({},"",t)):setTimeout(()=>{o(!1),window.history.pushState({},"",t)},1e3-e),i(0)},setProject:u}}({initialProject:t,isLoading:L,onProjectChange:e=>{R("random_button")},onUrlChange:e=>{P(e)}});(0,s.useEffect)(()=>{let e=async()=>{let e=await u(r);P((null==e?void 0:e.iframe_url)||""),A(!1)};t.need_passcode&&!t.iframe_url&&e()},[t.need_passcode,t.iframe_url]),function(e){let{projectUrl:t}=e;(0,s.useEffect)(()=>{if(t&&location.pathname===t)return;let e=eg();if(!e){window.history.replaceState(null,"",t);return}(0,eb.S)(e).then(e=>{var r;(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.is_valid)?window.history.replaceState(null,"",t):window.location.href="/404"}).catch(e=>{window.history.replaceState(null,"",t)})},[])}({projectUrl:t.project_url}),(0,s.useEffect)(()=>{T&&(U("app_page_view",{project_id:(null==V?void 0:V.project_id)||t.project_id,project_url:(null==V?void 0:V.project_url)||t.project_url,enter_from:E,is_ai_app:t.is_ai_app||!1}),(0,k.i)().then(e=>{d(t.project_id,"view",e,E)}))},[T]),(0,s.useEffect)(()=>{let e=I.get("comment_id");if(e){Z.setHighlightedComment(e);let r=new URLSearchParams(I);r.delete("comment_id");let n="".concat(window.location.pathname).concat(r.toString()?"?".concat(r.toString()):"");M.replace(n),i({project_id:t.project_id,page_size:15,anchor_comment_id:e}).then(t=>{if(0===t.code&&t.data){var r;(null===(r=t.data.comments)||void 0===r?void 0:r.some(t=>t.uuid===e))||t.data.anchor_comment||(0,v.P)({message:"This comment has been deleted.",type:"info"})}})}},[I,t.project_id,M,Z]);let ee=(0,s.useCallback)(e=>{Q({...V,comment_count:Math.max(0,e)})},[V]);return((0,s.useEffect)(()=>{var e;(null===(e=(0,S.j)())||void 0===e?void 0:e.client_id)||c()},[]),L)?(0,n.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center",children:[(0,n.jsx)(l.xNY,{className:"mx-auto mb-3 h-10 w-10 animate-spin text-gray-400"}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Loading..."})]}):t.need_passcode&&!T?(0,n.jsx)(ev,{subdomain:r,onVerificationSuccess:e=>{P(e)}}):(0,n.jsxs)("div",{className:"relative flex min-h-screen flex-col overflow-hidden",style:{minHeight:"100dvh"},children:[f&&(0,n.jsx)("h1",{className:"sr-only absolute top-0 left-[-10000px] h-[1px] w-[1px] overflow-hidden",children:f}),(0,n.jsx)("div",{className:(0,b.cn)("relative flex flex-1 overflow-hidden transition-all duration-300 sm:px-2 sm:pt-2",q?"pb-2":"pb-[72px] sm:pb-12"),children:(0,n.jsxs)("div",{className:"relative flex flex-1 overflow-hidden border-black/6 sm:rounded-2xl sm:border",children:[(0,n.jsx)(ex,{isPlaying:$}),(0,n.jsx)(w.A,{project:V,ref:j,src:T||"",mode:"consumer",className:"flex-1 overflow-hidden transition-all duration-300 ".concat(q?"!m-0 !rounded-none !border-none":""),loading:"eager",seamless:!0,onLoad:()=>{t.project_id!==V.project_id&&G()},onRequestLogin:async e=>new Promise((t,r)=>{Y?t({isLoggedIn:!0}):(0,N.S)({title:"Please log in to continue.",description:(null==e?void 0:e.description)||"You’ll need to log in to continue your activity.",cancelText:"Cancel",confirmText:"Log in",onCancel:()=>{r(Error("User cancelled login"))},onConfirm:()=>{let e=(0,C.$)(!0,!0)+window.location.pathname+window.location.search;M.push("".concat((0,C.$)(!0),"/login?returnTo=").concat(encodeURIComponent(e)))}})})})]})}),(0,n.jsx)("button",{onClick:J,className:"fixed right-2 bottom-2 z-50 cursor-pointer rounded-[10px] border border-black/12 bg-white p-2 transition-all duration-300 hover:bg-gray-100 ".concat(q&&!K?"translate-y-0 opacity-100":"translate-y-4 opacity-0"),children:(0,n.jsx)(l.a3o,{className:"h-4 w-4"})}),(0,n.jsx)("div",{className:"fixed bottom-0 left-0 z-50 w-full transition-all duration-300 ".concat(q?"translate-y-full":"translate-y-0"),children:(0,n.jsx)(X,{project:V,rolling:$,handleFullScreen:J,handleReport:()=>{U("app_report_button_click",{project_id:V.project_id,project_url:V.project_url}),H()},onRoll:()=>{B()},onShareClick:()=>D(!0),onUpdate:(e,r)=>{Q({...e,need_passcode:t.need_passcode,interaction:r})},onCommentClick:()=>{Z.togglePanel(),U("app_page_view",{action:"comment_panel_open",project_id:t.project_id,project_url:t.project_url})},isCommentPanelOpen:Z.isOpen})}),Z.isOpen&&(0,n.jsx)(ep,{project:V,...Z.commentPanelProps,onCommentCountChange:ee}),O&&(0,n.jsx)(g,{contentId:V.project_id,subjectType:"project",onClose:()=>z(!1),trackExtra:{project_id:V.project_id,project_url:V.project_url}}),F&&(0,n.jsx)(x.A,{project:V,onClose:()=>D(!1),location:"app_page"})]})}},59710:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var n=r(95155),l=r(6874),a=r.n(l);r(12115);var s=r(25827);function o(e){let{error:t="Something went wrong!",reset:r}=e;return(0,n.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,n.jsx)(s.default,{hideRight:!0}),(0,n.jsxs)("main",{className:"mb-20 flex w-full flex-1 flex-col items-center justify-center px-6 sm:px-4",children:[(0,n.jsx)("h2",{className:"text-center text-[28px]/8 sm:text-[32px]/9 md:text-[40px]/10",children:t}),(0,n.jsx)("p",{className:"mt-3 text-center text-sm text-black/45 sm:text-base",children:"Please try again later or contact support if the problem persists."}),(0,n.jsxs)("div",{className:"mt-12 flex gap-4 sm:mt-16 md:mt-20",children:[(0,n.jsx)("button",{onClick:()=>{r?r():window.location.reload()},className:"shine-effect flex h-12 w-36 cursor-pointer items-center justify-center rounded-full bg-black/95 text-sm text-white sm:h-14 sm:w-40 sm:text-base",children:"Try Again"}),(0,n.jsx)(a(),{href:"https://www.youware.com",className:"shine-effect flex h-12 w-36 cursor-pointer items-center justify-center rounded-full border border-black/95 text-sm text-black/95 sm:h-14 sm:w-40 sm:text-base",children:"Go Home"})]})]})]})}},61884:(e,t,r)=>{"use strict";function n(e){return e>1e3&&e<1e6?(e/1e3).toFixed(1)+"K":e>1e6?(e/1e6).toFixed(1)+"M":e>1e9?(e/1e9).toFixed(1)+"B":e}r.d(t,{Z:()=>n});let l=null;"undefined"!=typeof Intl&&"Segmenter"in Intl&&(l=new Intl.Segmenter(void 0,{granularity:"word"})),RegExp("^[\\p{P}\\p{Zs}]+$","u")},80191:(e,t,r)=>{"use strict";r.d(t,{V:()=>o.Vt,N:()=>m});var n=r(35695),l=r(12115),a=r(34477);let s=(0,a.createServerReference)("60d7ce557c6a2c4e3b865bc11edd5c8cc98944f0b0",a.callServer,void 0,a.findSourceMapURL,"remixProject");var o=r(70165),c=r(565),i=r(90239),d=r(66139),u=r(48436),p=r(89003);let x=e=>({remix:"Failed to remix project, please try again later",create:"Failed to create project, please try again later"})[e],m=()=>{let e=(0,n.useRouter)(),t=(0,i.I)(),{checkAuth:r}=(0,p.M)(),[a,o]=(0,l.useState)(!1);return{remixAction:(0,l.useCallback)(async(t,n)=>r(async()=>{o(!0);try{let r=await (0,c.i)(),l=await s(t,r);if(l.data){let t=(0,d.$)(),r={enter_from:n};"create"===n&&(r.createWeb="true"),e.push("".concat(t,"/editor/").concat(l.data.project_id,"?").concat(new URLSearchParams(r).toString()))}else(0,u.P)({message:x(n),type:"error"})}catch(e){console.log("error",e),(0,u.P)({message:x(n),type:"error"})}finally{o(!1)}setTimeout(()=>{o(!1)},1e3)},{title:"Want to remix this project?",description:"Log in to remix and customize it your way.",cancelText:"Cancel",confirmText:"Log in"})(),[t,e]),isRemixing:a}}},80878:(e,t,r)=>{"use strict";r.d(t,{s:()=>l});var n=r(34477);let l=(0,n.createServerReference)("605f5d9bbb721c8d73f69671ecc5ff03d281c3c2f1",n.callServer,void 0,n.findSourceMapURL,"favoriteProject")}},e=>{var t=t=>e(e.s=t);e.O(0,[8823,8888,2873,7740,209,5649,2216,4145,3600,5827,915,1844,4850,8441,7768,7358],()=>t(23468)),_N_E=e.O()}]);